# Introduction

This is incomplete for now

# Code Walk Through

The function

```cpp
void my_mult_axis(uint32_t const * S_AXIS, uint32_t * D_AXIS)
{
    uint32_t v = *S_AXIS;

    uint16_t a = v>>16;
    uint16_t b = v&0xFFFF;

    uint32_t r = a*b;

    *D_AXIS = r;
}
```

1. Read  32 bits from the input stream
2. Split hi/low 16 bits into variables `a` and `b`
3. Compute product of `a*b` (32 bits)
4. Write result to the output stream


# Steps

Creating Vivado HLS project and building IP:

    vivado_hls -f ./gen_project.tcl


Open vivado hls project:

    vivado_hls -p my_mult_axis

Things to try:

1. `Project > Run C Simulation`
2. Look through reports: `syn/report/<...>.rpt`
3. Step through C simulation with debugger
4. Checkout "Analysis" Perspective

Creating Vivado Project

    ../../scripts/gen_project.sh --name dma_mult_test --bd dma_loopback --7010

Then add IP Repo (`./my_mult_axis/axis/impl/ip/`) to the project, and
replace `axis_data_fifo` with `my_mult_axis` in the block design.


TCL to that:

```tcl
# Remove FIFO object first
delete_bd_objs [get_bd_cells axis_data_fifo_0]

# Add ip generated by HLS
create_bd_cell -type ip -vlnv k88k:hls:my_mult_axis:1.0 my_mult_axis_0

# Hook up my_mult_0 to axi_dma_0
connect_bd_intf_net [get_bd_intf_pins my_mult_axis_0/S_AXIS   ]   [get_bd_intf_pins axi_dma_0/M_AXIS_MM2S     ]
connect_bd_intf_net [get_bd_intf_pins my_mult_axis_0/D_AXIS   ]   [get_bd_intf_pins axi_dma_0/S_AXIS_S2MM     ]
connect_bd_net      [get_bd_pins      my_mult_axis_0/ap_rst_n ]   [get_bd_pins      axi_dma_0/axi_resetn      ]
connect_bd_net      [get_bd_pins      my_mult_axis_0/ap_clk   ]   [get_bd_pins      axi_dma_0/m_axi_mm2s_aclk ]

# Passthrough tlast signal from MM2S to S2MM
connect_bd_net [get_bd_pins axi_dma_0/m_axis_mm2s_tlast] [get_bd_pins axi_dma_0/s_axis_s2mm_tlast]

# Clean up
regenerate_bd_layout
validate_bd_design
save_bd_design
```